<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
<div id="data"></div>

<script type="text/javascript" src="js/vendor/d3.v4.min.js"></script>
<script type="text/javascript">
function loadJSON(path, success, error)	{
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function()
		{
			if (xhr.readyState === XMLHttpRequest.DONE) {
				if (xhr.status === 200) {
					if (success)
						success(JSON.parse(xhr.responseText));
				} else {
					if (error)
						error(xhr);
				}
			}
		};
		xhr.open("GET", path, true);
		xhr.send();
	}

	function loadDATA() {
		loadJSON("getRecentByName_name_tafelvoetbal.json?" + Date.now(),
				 function(data) {
                     console.log(data);
                     data = parseData(data)
                     barChart(data,"#data")
                 },
                function(xhr) { console.error(xhr); }
       )
   }
   loadDATA()

   function parseData(data) {

       var eighthoursago = Math.floor((Date.now() - 28800)/1000);
       console.log(eighthoursago);
       var eighthours = [];
       var counthours = Math.floor((Date.now() - 28800)/1000);
       var unixTimeInterval = 28800
       for (var i = 0; i < unixTimeInterval/60; i++) {

           eighthours.push({
               "label": "nu",
               "value": 1
           })
           counthours += unixTimeInterval;
       }
       console.log(eighthours);
       return eighthours;

       // var dateStart oor((dateEnd - dateStart) /1000);

       // = new Date(data[0].dateTime);
       //
       // var dateEnd = new Date(data[data.length-1].dateTime);
       //
       // var usedTime = Math.fl

       // for (var i = 0; i < data.length; i++) {
       //      var d = new Date(data[i].dateTime);
       //
       //      data[i].label = Number(d);
       //      data[i].value = 1;
       // }
       // return data;
   }

   function barChart(data,element) {
   		// set the dimensions and margins of the graph
   		var margin = {top: 20, right: 20, bottom: 40, left: 40},
   		width = 800 - margin.left - margin.right,
   		height = 300 - margin.top - margin.bottom;

   		// set the ranges
   		var x = d3.scaleBand()
   			.range([0, width])
   			.padding(0.1);
   		var y = d3.scaleLinear()
   			.range([height, 0]);

   		// append the svg object to the body of the page
   		// append a 'group' element to 'svg'
   		// moves the 'group' element to the top left margin
   		var svg = d3.select(element).append("svg")
   				.attr("preserveAspectRatio", "xMinYMin meet")
   				.attr("viewBox", "0 0 " + width + " " + height)

   			.attr("width", width + margin.left + margin.right)
   			.attr("class","bar")
   			.attr("height", height + margin.top + margin.bottom)
   			.attr("fill", "#008BFF")

   			.append("g")
   			.attr("transform",
   			"translate(" + margin.left + "," + margin.top + ")");

   		// Scale the range of the data in the domains
   		x.domain(data.map(function(d) { return d.label; }));
   		y.domain([0, d3.max(data, function(d) { return d.value; })]);

   		// append the rectangles for the bar chart
   		svg.selectAll(".bar")
   			.data(data)
   			.enter().append("rect")
   			.attr("class", "bar")
   			.attr("x", function(d) { return x(d.label); })
   			.attr("width", x.bandwidth())
   			.attr("y", function(d) { return y(d.value); })
   			.attr("height", function(d) { return height - y(d.value); });

   		// add the x Axis
   		svg.append("g")
   			.attr("transform", "translate(0," + height + ")")
   			.attr("stroke", "white")
   			.call(d3.axisBottom(x));

   		// add the y Axis
   		svg.append("g")
   			.attr("stroke", "white")
   			.call(d3.axisLeft(y));
   	}
</script>

    <!-- <script type="text/javascript">
        var xmlhttp = new XMLHttpRequest();
        // var url = "api/getRecentByName?name=tafelvoetbal";
        var url = "getRecentByName_name_tafelvoetbal.json";

        xmlhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var myArr = JSON.parse(this.responseText);
                console.log(myArr);
            }
        };

        xmlhttp.open("GET", url, true);
        xmlhttp.send();
    </script> -->


</body>
</html>
