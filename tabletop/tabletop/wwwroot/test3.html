<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<style>

		#work_queues_chart div {
		    font-size: 0.5em;
		    font-family: sans-serif;
		    color: white;
		    background-color: steelblue;
		    text-align: right;
		    /* padding: 0.5em; */
		    /* margin: 0.2em; */
			display: block;
		}

		</style>
	</head>
	<body>
		<svg id="work_queues_chart"></svg>
<button id="update">Update</button>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>


		<script type="text/javascript">

		function draw(data) {

			var margin = {top: 10, right: 0, bottom: 20, left: 30},
			width = 800 + (margin.right - margin.left),
			height = 300 + (margin.top - margin.bottom);

		    var bars = d3.select("#work_queues_chart")
				.attr("preserveAspectRatio", "xMinYMin meet")
				.attr("viewBox", "0 0 " + (width + margin.left + margin.right) + " " + height)
				.attr("width", width + margin.left + margin.right)
				.attr("class","bar")
				.attr("height", height + margin.top + margin.bottom)
				.attr("fill", "#CCC")
				.attr("transform","translate(" + margin.left + "," + margin.top + ")")

		        .selectAll("rect")
		        .data(data);


			// set the ranges
			var x = d3.scaleBand()
				.range([0, width])
				.padding(0.1);
			var y = d3.scaleLinear()
				.range([height, 0]);

				console.log(data);
			// Scale the range of the data in the domains
			x.domain(data.map(function(d) { console.log(d.label); return d.label; }));
			y.domain([0, d3.max(data, function(d) { console.log(d.value); return d.value; })]);

			// if (svglength === 0) {}
				// add the x Axis
			svg = d3.select("#work_queues_chart")
			svg.append("g")
				.attr("transform", "translate(0," + height + ")")
				.attr("stroke", "#fff")
				.call(d3.axisBottom(x));

			// add the y Axis
			svg.append("g")
				.attr("stroke", "#000")
				.call(d3.axisLeft(y));

		    // enter and update selection
		    bars
		      .enter().append("rect")
		      .merge(bars)
			  .attr("x", function(d) { return x(d.label); })
			  .attr("width", x.bandwidth())
			  .attr("y", function(d) { return y(d.value); })
			  .attr("height", function(d) { return height - y(d.value); })
		      // .text(function (d) {return d;});

		    // exit selection
		    bars
		        .exit().remove();
		};

		function update() {
			var data = [];
			data.push({ id: "id_1515732013", label: "2018-01-12T04:40:13.000Z", value: 1 });
			data.push({ id: "id_1515732014", label: "2018-01-12T04:41:13.000Z", value: 1 });
			data.push({ id: "id_1515732015", label: "2018-01-12T04:42:14.000Z", value: 1 });
			data.push({ id: "id_1515732016", label: "2018-01-12T04:42:15.000Z", value: 1 });
			data.push({ id: "id_1515732017", label: "2018-01-12T04:42:16.000Z", value: 1 });
			data.push({ id: "id_1515732017", label: "2018-01-12T04:42:17.000Z", value: 1 });
			data.push({ id: "id_1515732017", label: "2018-01-12T04:42:18.000Z", value: 1 });
			data.push({ id: "id_1515732017", label: "2018-01-12T04:42:19.000Z", value: 1 });
			data.push({ id: "id_1515732017", label: "2018-01-12T04:42:20.000Z", value: 1 });

		    // var data = [4, 8, 15, 16, 23, 42];
		    draw(data);
		};

		// var data = [10, 10, 10, 10, 10, 10];
		var data = [];
		data.push({ id: "id_1515732013", label: "2018-01-12T04:40:13.000Z", value: 2 });
		data.push({ id: "id_1515732014", label: "2018-01-12T04:41:13.000Z", value: 4 });
		data.push({ id: "id_1515732015", label: "2018-01-12T04:42:13.000Z", value: 5 });

		window.onload = draw(data);

		d3.select('#update')
		    .on("click",update);

		</script>


	</body>
</html>
